call(this)}).call(this, "/components/user-account-nav/client.js")}, { "5": 5, "10": 10, "16": 16, "17": 17, "23": 23, "24": 24, "25": 25, "28": 28, "29": 29, "34": 34, "36": 36, "43": 43, "97": 97, "130": 130, "134": 134, "138": 138, "334": 334, "336": 336, "348": 348, "349": 349 }];
window.modules["search.client"] = [function (require, module, exports) {
    "use strict"; var _interopRequireDefault = require(10), _regenerator = _interopRequireDefault(require(25)), _asyncToGenerator2 = _interopRequireDefault(require(24)), _defineProperty2 = _interopRequireDefault(require(18)), _classCallCheck2 = _interopRequireDefault(require(12)), _createClass2 = _interopRequireDefault(require(11)), _assertThisInitialized2 = _interopRequireDefault(require(319)), _inherits2 = _interopRequireDefault(require(13)), _possibleConstructorReturn2 = _interopRequireDefault(require(14)), _getPrototypeOf2 = _interopRequireDefault(require(15)); function ownKeys(e, t) { var r = Object.keys(e); if (Object.getOwnPropertySymbols) { var n = Object.getOwnPropertySymbols(e); t && (n = n.filter(function (t) { return Object.getOwnPropertyDescriptor(e, t).enumerable })), r.push.apply(r, n) } return r } function _objectSpread(e) { for (var t = 1; t < arguments.length; t++) { var r = null != arguments[t] ? arguments[t] : {}; t % 2 ? ownKeys(Object(r), !0).forEach(function (t) { (0, _defineProperty2.default)(e, t, r[t]) }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(r)) : ownKeys(Object(r)).forEach(function (t) { Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(r, t)) }) } return e } function _createSuper(e) { var t = _isNativeReflectConstruct(); return function () { var r, n = (0, _getPrototypeOf2.default)(e); if (t) { var a = (0, _getPrototypeOf2.default)(this).constructor; r = Reflect.construct(n, arguments, a) } else r = n.apply(this, arguments); return (0, _possibleConstructorReturn2.default)(this, r) } } function _isNativeReflectConstruct() { if ("undefined" == typeof Reflect || !Reflect.construct) return !1; if (Reflect.construct.sham) return !1; if ("function" == typeof Proxy) return !0; try { return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () { })), !0 } catch (e) { return !1 } } var _require = require(16), ClientModel = _require.ClientModel, initializeOnLoad = _require.initializeOnLoad, _require2 = require(97), trackMetrics = _require2.trackMetrics, _require3 = require(96), lineClamp = _require3.lineClamp, cnnSearch = require(320), _debounce = require(49), createContainer = require(99), _require4 = require(36), addSearchTermTracking = _require4.addSearchTermTracking, addGenericClickAnalytics = _require4.addGenericClickAnalytics, addZJSClickAttributes = _require4.addZJSClickAttributes, _require5 = require(32), toPlainText = _require5.toPlainText, CLICKED = "clicked", HIDDEN = "hidden", INPUT_SEARCH_DEBOUNCE = 500, PAGI_NEXT = "pagination-arrow-right", PAGI_PREV = "pagination-arrow-left", NEWEST_SORT = "newest", RELEVANCE_SORT = "relevance", MOBILE_POSTFIX = "-mobile", SEARCH_NO_RESULTS = "search__no-results--show", SEARCH_PATH = "/search?", DEFAULT_SEARCH_OPTIONS = { from: 0, page: 1, size: 10 }, SEARCH_PARAMS = ["q", "size", "from", "sort", "types", "section", "page"], ZION_CLICK_ELEMS = { TYPE_FILTER: "typeFilter", SORT_FILTER: "sortFilter" }, Search = function (e) { (0, _inherits2.default)(r, e); var t = _createSuper(r); function r(e) { var n; return (0, _classCallCheck2.default)(this, r), (n = t.call(this, e)).sectionFilter = n.getQueryParam("section") || "", n.sortVal = n.getQueryParam("sort") || NEWEST_SORT, n.typeFilter = n.getQueryParam("types") || "all", n.currentPage = /^[0-9]+$/.test(n.getQueryParam("page")) ? parseInt(n.getQueryParam("page")) : 1, n.from = /^[0-9]+$/.test(n.getQueryParam("from")) ? parseInt(n.getQueryParam("from")) : 0, n.size = /^[0-9]+$/.test(n.getQueryParam("size")) ? parseInt(n.getQueryParam("size")) : 10, n.resultsCount = 0, n.input = e.querySelector(".search__input"), n.resultsCountContainer = e.querySelector(".search__results-count"), n.resultsListContainer = e.querySelector(".search__results-list"), n.paginationContainer = e.querySelector(".search__results-pagi"), n.cnnSearchQueryContainer = e.querySelector("#search__query"), n.noResultsContainer = e.querySelector(".search__no-results"), n.noResultsContainerMessage = e.querySelector(".search__no-results__message"), n.topTabs = e.querySelector(".search__facets.top__tabs"), n.searchButton = e.querySelector(".search__button"), n.clearButton = e.querySelector(".search__clear"), n.sortDropMenu = e.querySelectorAll(".search__sort"), n.sortDropMenuMobile = e.querySelector(".search__sort.mobile"), n.sortDropMenuItems = e.querySelectorAll(".search__sort .facet__item"), n.trackSearchTermMetrics = n.initSearchTermMetrics(addSearchTermTracking), n.sortClickZionTracking = n.setupElemClickTracking(ZION_CLICK_ELEMS.SORT_FILTER), n.typeClickZionTracking = n.setupElemClickTracking(ZION_CLICK_ELEMS.TYPE_FILTER), n.debouncedSearch = _debounce(n.search.bind((0, _assertThisInitialized2.default)(n), _objectSpread(_objectSpread({}, DEFAULT_SEARCH_OPTIONS), {}, { search_type: "autosearch" })), INPUT_SEARCH_DEBOUNCE), n.input.addEventListener("input", n.debouncedSearch.bind((0, _assertThisInitialized2.default)(n))), n.searchButton.addEventListener("click", function () { n.search(DEFAULT_SEARCH_OPTIONS) }), n.clearButton.addEventListener("click", function () { n.query = "" }), n.topTabs.addEventListener("click", function (e) { var t, r; "radio" === (null === (t = e.target) || void 0 === t ? void 0 : t.type) && "collection" === (null === (r = e.target) || void 0 === r ? void 0 : r.name) && (n.typeFilter = encodeURI(e.target.value), n.search(DEFAULT_SEARCH_OPTIONS, ZION_CLICK_ELEMS.TYPE_FILTER)) }), n.paginationContainer.addEventListener("click", function (e) { var t = function (e) { return e <= 1 ? 0 : 10 * (e - 1) }; e.target.classList.contains("search__pagi-num") && (window.scrollTo(0, 0), n.currentPage = /^[0-9]+$/.test(e.target.innerHTML) ? parseInt(e.target.innerHTML) : 1, n.from = t(n.currentPage), n.search({ from: n.from, size: n.size, page: n.currentPage })), e.target.classList.contains("pagination-arrow") && (window.scrollTo(0, 0), e.target.classList.contains(PAGI_PREV) ? (n.currentPage -= n.currentPage <= 1 ? 0 : 1, n.from = t(n.currentPage)) : e.target.classList.contains(PAGI_NEXT) && (n.currentPage += 1, n.from = t(n.currentPage)), n.search({ from: n.from, size: n.size, page: n.currentPage })) }), n.sortDropMenu.forEach(function (e) { return e.addEventListener("click", n.onClickSortMenu.bind((0, _assertThisInitialized2.default)(n))) }), n.pagination({ size: 10, page: n.currentPage }), n.setInitialSelected(e), n.search(), n } return (0, _createClass2.default)(r, [{ key: "decode_and_clean", value: function (e) { return toPlainText(toPlainText(e)) } }, { key: "query", get: function () { var e; return this._query = this.decode_and_clean(null === (e = this.input) || void 0 === e ? void 0 : e.value) || "", this._query }, set: function (e) { this._query = this.decode_and_clean(e), this.input && (this.input.value = this._query) } }, { key: "onClickSortMenu", value: function (e) { var t, r = e.target.id.replace(MOBILE_POSTFIX, ""); (this.sortDropMenuMobile.classList.toggle("open"), !r || r !== RELEVANCE_SORT && r !== NEWEST_SORT) || (null === (t = this.sortDropMenuItems) || void 0 === t || t.forEach(function (e) { return e.classList.remove(CLICKED) }), document.getElementById(r).classList.add(CLICKED), document.getElementById(r + MOBILE_POSTFIX).classList.add(CLICKED), this.sortVal = r, this.search(DEFAULT_SEARCH_OPTIONS, ZION_CLICK_ELEMS.SORT_FILTER)) } }, { key: "getQueryParam", value: function (e) { return SEARCH_PARAMS.includes(e) ? new URLSearchParams(window.location.search).get(e) : "" } }, { key: "resetContainers", value: function () { this.resultsCountContainer.innerHTML = "", this.resultsListContainer.innerHTML = "", this.cnnSearchQueryContainer.innerHTML = "" } }, { key: "setInitialSelected", value: function (e) { var t, r, n; e.querySelector("#collection_".concat(this.typeFilter)).checked = !0, null === (t = e.querySelector("#section_".concat(this.sectionFilter))) || void 0 === t || t.classList.add("clicked"), null === (r = e.querySelector("#".concat(this.sortVal))) || void 0 === r || r.classList.add("clicked"), null === (n = e.querySelector("#".concat(this.sortVal, "-mobile"))) || void 0 === n || n.classList.add("clicked"), this.query = this.getQueryParam("q") || "", this.showContentSections(!0) } }, { key: "displayResultsMessage", value: function (e) { var t = e.start, r = e.end, n = e.of, a = this.query, i = ""; a && (i = 'for <strong id="search__query">'.concat(a, "</strong>")); var s = "Displaying ".concat(t, "-").concat(r, " results out of ").concat(n, " ").concat(i); this.resultsCountContainer.insertAdjacentHTML("afterbegin", s) } }, { key: "renderResults", value: function (e, t) { var r = this; this.resetContainers(), this.displayResultsMessage(t), createContainer(e, this.resultsListContainer, "search", "container_list-images-with-description"), this.resultsListContainer.querySelectorAll('[data-uri*="/card/"]').forEach(function (e, t) { var n = t + 1 + r.from, a = e.querySelector("a[href]").href, i = e.querySelector('[data-editable="headline"]'), s = e.querySelector(".container__date"), o = e.querySelector('[data-editable="description"]'), c = e.querySelector(".image__dam-img"); r.addZJStoSearchCard(i, n, a), r.addZJStoSearchCard(s, n, a), lineClamp(o, 3, " ..."), r.addZJStoSearchCard(o, n, a), r.addZJStoSearchCard(c, n, a) }) } }, { key: "addZJStoSearchCard", value: function (e, t, r) { addZJSClickAttributes(e, { href: r, component_position: t, canonical_url: window.CNN.contentModel.canonicalUrl, cms_id: window.CNN.contentModel.cmsId, "traits-search_term": this.query, "traits-search_results_number": this.resultsCount }) } }, { key: "showContentSections", value: function (e) { e ? (this.paginationContainer.classList.remove(HIDDEN), this.noResultsContainer.classList.remove(SEARCH_NO_RESULTS), this.sortDropMenu.forEach(function (e) { return e.classList.remove(HIDDEN) })) : (this.resetContainers(), this.paginationContainer.classList.add(HIDDEN), this.noResultsContainer.classList.add(SEARCH_NO_RESULTS), this.sortDropMenu.forEach(function (e) { return e.classList.add(HIDDEN) })) } }, { key: "hasClassName", value: function (e, t) { var r; return null === (r = e.classList) || void 0 === r ? void 0 : r.contains(t) } }, { key: "renderNoResultsMessage", value: function () { var e = this.query, t = ""; e.length > 0 && (t = "Your search for <b>".concat(e, "</b> did not match any results.")), this.noResultsContainerMessage.innerHTML = t } }, { key: "sendAnalytics", value: function () { var e = this.resultsCount || "zero"; trackMetrics({ type: "cnnsearch-results", data: { search_results_count: e, search_results_page: this.currentPage || 1, search_term: this.query || "" } }) } }, { key: "pagination", value: function (e) { var t, r = e.size, n = parseInt(e.page), a = n + 2, i = "", s = n, o = Math.ceil(parseInt(this.resultsCount, r) / r); for (s <= 3 ? (n = 1, a = a >= o ? o : 5) : n = s - 2, a >= o && (n = o <= 5 ? 1 : a - 2, a = o), i += '<div class="pagination-bar"><div class="pagination-arrow pagination-arrow-left', i += s > 1 ? " search__pagination-link text-active" : " text-inactive", i += '"><svg class="icon-ui-arrow-left" width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M2.203 12.064l7.854 7.875c.271.272.71.272.982 0a.698.698 0 000-.985l-6.622-6.697H21.31c.529 0 .69-.338.69-.655 0-.356-.284-.716-.69-.716H4.414l6.625-6.698a.698.698 0 000-.984.693.693 0 00-.982 0l-7.854 7.875a.698.698 0 000 .985"/></svg><span class="pagination-arrow-text">Prev</span></div><div class="pagination-digits">', t = n; t <= a; t++) { i += '<span class="'.concat(t === s ? "search__pagination-link search__pagination-link--active" : "search__pagi-num search__pagination-link", '">').concat(t, "</span>").concat(t < a ? " " : "") } i += '</div><div class="pagination-arrow pagination-arrow-right', i += s < o ? " search__pagination-link text-active" : " text-inactive", i += '"><span class="pagination-arrow-text">Next</span><svg class="icon-ui-arrow-right" width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21.797 12.063l-7.854 7.876a.693.693 0 01-.982 0 .697.697 0 010-.985l6.622-6.697H2.69c-.529 0-.69-.339-.69-.655 0-.356.284-.716.69-.716h16.896l-6.625-6.698a.697.697 0 010-.984.693.693 0 01.982 0l7.854 7.875a.697.697 0 010 .984"/></svg></div></div></li>', this.paginationContainer && (this.paginationContainer.innerHTML = "", this.paginationContainer.insertAdjacentHTML("afterbegin", i)) } }, { key: "setNewUrl", value: function (e) { var t = new URLSearchParams(document.location.search); t.set("q", this.query), t.set("from", e.from), t.set("size", e.size), t.set("page", e.page), t.set("sort", this.sortVal), t.set("types", this.typeFilter), t.set("section", this.sectionFilter), window.history.pushState({ id: document.title, source: "web" }, document.title, SEARCH_PATH + t.toString()) } }, { key: "initSearchTermMetrics", value: function (e) { var t = null; return function (r) { t !== r.search_term && (e(r), t = r.search_term) } } }, { key: "setupElemClickTracking", value: function (e) { var t = { typeFilter: "search_category", sectionFilter: "search_section", sortFilter: "sort_type" }; return function (r, n) { var a = _objectSpread((0, _defineProperty2.default)({}, t[e], r), n); addGenericClickAnalytics({ componentId: "search", componentType: "search", traits: a }) } } }, { key: "search", value: function () { var e = (0, _asyncToGenerator2.default)(function (e) { var t = this, r = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : ""; return _regenerator.default.mark(function n() { var a, i, s, o, c, l, u; return _regenerator.default.wrap(function (n) { for (; ;)switch (n.prev = n.next) { case 0: return a = t.query, i = e ? { from: t.from = e.from, size: t.size = e.size, page: t.currentPage = e.page, search_type: e.search_type || "" } : { from: t.from, size: t.size, page: t.currentPage, search_type: "" }, t.cnnSearchQueryContainer.innerHTML = a || "", n.prev = 3, n.next = 6, cnnSearch.search(a, i, t.sectionFilter, t.typeFilter, t.sortVal); case 6: if (s = n.sent, t.query !== a) { n.next = 21; break } t.resultsCount = null != s && null !== (o = s.meta) && void 0 !== o && o.of ? s.meta.of : 0, (null == s ? void 0 : null === (c = s.result) || void 0 === c ? void 0 : c.length) > 0 ? (l = s.result.map(function (e) { return { path: e.path, type: e.type, headline: e.headline, thumbnail: e.thumbnail, sourceId: e.sourceId, url: e.url, lastModifiedDate: e.lastModifiedDate, body: e.body } }), t.showContentSections(!0), t.renderResults(l, s.meta), t.pagination(i)) : (t.showContentSections(!1), t.resetContainers(), t.renderNoResultsMessage()), t.sendAnalytics(s.meta), t.setNewUrl(i), t.trackSearchTermMetrics({ search_term: a, search_results_number: t.resultsCount, search_category: t.typeFilter, search_section: t.sectionFilter, search_type: i.search_type, sort_type: t.sortVal }), u = { search_results_number: t.resultsCount, search_term: a }, n.t0 = r, n.next = n.t0 === ZION_CLICK_ELEMS.SORT_FILTER ? 17 : n.t0 === ZION_CLICK_ELEMS.TYPE_FILTER ? 19 : 21; break; case 17: return t.sortClickZionTracking(t.sortVal, u), n.abrupt("break", 21); case 19: return t.typeClickZionTracking(t.typeFilter, u), n.abrupt("break", 21); case 21: n.next = 26; break; case 23: n.prev = 23, n.t1 = n.catch(3), console.error(n.t1); case 26: case "end": return n.stop() } }, n, null, [[3, 23]]) })() }); return function (t) { return e.apply(this, arguments) } }() }]), r }(ClientModel); module.exports = initializeOnLoad(Search);
}, { "10": 10, "11": 11, "12": 12, "13": 13, "14": 14, "15": 15, "16": 16, "18": 18, "24": 24, "25": 25, "32": 32, "36": 36, "49": 49, "96": 96, "97": 97, "99": 99, "319": 319, "320": 320 }];